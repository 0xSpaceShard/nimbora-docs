"use strict";(self.webpackChunknimbora_yield_dex=self.webpackChunknimbora_yield_dex||[]).push([[656],{7928:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>g,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=n(7624),s=n(2172);const i={id:"pooling_manager",title:"Pooling Manager",sidebar_position:1},d=void 0,a={id:"contracts/reference/L1 Contracts/pooling_manager",title:"Pooling Manager",description:"l2PoolingManager",source:"@site/docs/contracts/reference/L1 Contracts/PoolingManager.md",sourceDirName:"contracts/reference/L1 Contracts",slug:"/contracts/reference/L1 Contracts/pooling_manager",permalink:"/docs/contracts/reference/L1 Contracts/pooling_manager",draft:!1,unlisted:!1,editUrl:"https://github.com/0xSpaceShard/nimbora_yields_l2/docs/contracts/reference/L1 Contracts/PoolingManager.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"pooling_manager",title:"Pooling Manager",sidebar_position:1},sidebar:"contractsSidebar",previous:{title:"How to create new strategies",permalink:"/docs/contracts/guides/create_strategy"},next:{title:"Starknet Messaging",permalink:"/docs/contracts/reference/L1 Contracts/starknet_messaging"}},l={},c=[{value:"l2PoolingManager",id:"l2poolingmanager",level:3},{value:"strategyInfo",id:"strategyinfo",level:3},{value:"batchCounter",id:"batchcounter",level:3},{value:"ethBridge",id:"ethbridge",level:3},{value:"ethWrapped",id:"ethwrapped",level:3},{value:"pendingRequests",id:"pendingrequests",level:3},{value:"pendingRequestsExecuted",id:"pendingrequestsexecuted",level:3},{value:"pendingRequestsExecutedCounter",id:"pendingrequestsexecutedcounter",level:3},{value:"PendingRequestsExecuted",id:"pendingrequestsexecuted-1",level:3},{value:"MessageResentToL2",id:"messageresenttol2",level:3},{value:"BridgeCancelDepositRequestClaimedAndDeposited",id:"bridgecanceldepositrequestclaimedanddeposited",level:3},{value:"CancelDepositRequestBridgeSent",id:"canceldepositrequestbridgesent",level:3},{value:"ReportHandled",id:"reporthandled",level:3},{value:"StrategyRegistered",id:"strategyregistered",level:3},{value:"L2_HANDLER_SELECTOR",id:"l2_handler_selector",level:3},{value:"RELAYER_ROLE",id:"relayer_role",level:3},{value:"receive",id:"receive",level:3},{value:"fallback",id:"fallback",level:3},{value:"constructor",id:"constructor",level:3},{value:"initialize",id:"initialize",level:3},{value:"Parameters",id:"parameters",level:4},{value:"hashFromReportL2",id:"hashfromreportl2",level:3},{value:"hashFromReportL1",id:"hashfromreportl1",level:3},{value:"bridgeEthFeesMultiplicator",id:"bridgeethfeesmultiplicator",level:3},{value:"registerStrategy",id:"registerstrategy",level:3},{value:"setPoolingManager",id:"setpoolingmanager",level:3},{value:"cancelDepositRequestBridge",id:"canceldepositrequestbridge",level:3},{value:"claimBridgeCancelDepositRequestAndDeposit",id:"claimbridgecanceldepositrequestanddeposit",level:3},{value:"pause",id:"pause",level:3},{value:"unpause",id:"unpause",level:3},{value:"executePendingRequests",id:"executependingrequests",level:3},{value:"handleReport",id:"handlereport",level:3},{value:"getMessagePayloadData",id:"getmessagepayloaddata",level:3},{value:"deleteElement",id:"deleteelement",level:3},{value:"verifyCallData",id:"verifycalldata",level:3},{value:"withdrawFromBridges",id:"withdrawfrombridges",level:3},{value:"depositToBridges",id:"deposittobridges",level:3},{value:"handleMassReport",id:"handlemassreport",level:3},{value:"processStrategyReports",id:"processstrategyreports",level:3},{value:"processPendingRequests",id:"processpendingrequests",level:3},{value:"mergeReportsAndUpdateDeposits",id:"mergereportsandupdatedeposits",level:3},{value:"processPendingRequest",id:"processpendingrequest",level:3}];function o(e){const t={code:"code",em:"em",h3:"h3",h4:"h4",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.M)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h3,{id:"l2poolingmanager",children:"l2PoolingManager"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"uint256 l2PoolingManager\n"})}),"\n",(0,r.jsx)(t.h3,{id:"strategyinfo",children:"strategyInfo"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"mapping(address => struct StrategyInfo) strategyInfo\n"})}),"\n",(0,r.jsx)(t.h3,{id:"batchcounter",children:"batchCounter"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"uint256 batchCounter\n"})}),"\n",(0,r.jsx)(t.h3,{id:"ethbridge",children:"ethBridge"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"address ethBridge\n"})}),"\n",(0,r.jsx)(t.h3,{id:"ethwrapped",children:"ethWrapped"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"address ethWrapped\n"})}),"\n",(0,r.jsx)(t.h3,{id:"pendingrequests",children:"pendingRequests"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"struct StrategyReportL2[] pendingRequests\n"})}),"\n",(0,r.jsx)(t.h3,{id:"pendingrequestsexecuted",children:"pendingRequestsExecuted"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"struct StrategyReportL1[] pendingRequestsExecuted\n"})}),"\n",(0,r.jsx)(t.h3,{id:"pendingrequestsexecutedcounter",children:"pendingRequestsExecutedCounter"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"uint256 pendingRequestsExecutedCounter\n"})}),"\n",(0,r.jsx)(t.h3,{id:"pendingrequestsexecuted-1",children:"PendingRequestsExecuted"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event PendingRequestsExecuted(uint256[] indices)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"messageresenttol2",children:"MessageResentToL2"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event MessageResentToL2()\n"})}),"\n",(0,r.jsx)(t.h3,{id:"bridgecanceldepositrequestclaimedanddeposited",children:"BridgeCancelDepositRequestClaimedAndDeposited"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event BridgeCancelDepositRequestClaimedAndDeposited(address l1BridgeAddress, uint256 amount, uint256 nonce)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"canceldepositrequestbridgesent",children:"CancelDepositRequestBridgeSent"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event CancelDepositRequestBridgeSent(address l1BridgeAddress, uint256 amount, uint256 nonce)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"reporthandled",children:"ReportHandled"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event ReportHandled(uint256 epoch, uint256 strategyReportL1Length, struct StrategyReportL1[] strategyReportL1)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"strategyregistered",children:"StrategyRegistered"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"event StrategyRegistered(address strategy, struct StrategyInfo strategyInfo)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"l2_handler_selector",children:"L2_HANDLER_SELECTOR"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"uint256 L2_HANDLER_SELECTOR\n"})}),"\n",(0,r.jsx)(t.h3,{id:"relayer_role",children:"RELAYER_ROLE"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"bytes32 RELAYER_ROLE\n"})}),"\n",(0,r.jsx)(t.h3,{id:"receive",children:"receive"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"receive() external payable\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.em,{children:"Receive Ether function"})}),"\n",(0,r.jsx)(t.h3,{id:"fallback",children:"fallback"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"fallback() external payable\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.em,{children:"Fallback function"})}),"\n",(0,r.jsx)(t.h3,{id:"constructor",children:"constructor"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"constructor() public\n"})}),"\n",(0,r.jsx)(t.h3,{id:"initialize",children:"initialize"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function initialize(address _owner, uint256 _l2PoolingManager, address _starknetCore, address _relayer, address _ethBridge, address _ethWrapped) public\n"})}),"\n",(0,r.jsx)(t.p,{children:"Initialier the contract state."}),"\n",(0,r.jsx)(t.h4,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Name"}),(0,r.jsx)(t.th,{children:"Type"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_owner"}),(0,r.jsx)(t.td,{children:"address"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_l2PoolingManager"}),(0,r.jsx)(t.td,{children:"uint256"}),(0,r.jsx)(t.td,{children:"troveManager address"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_starknetCore"}),(0,r.jsx)(t.td,{children:"address"}),(0,r.jsx)(t.td,{children:"starknetCore address"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_relayer"}),(0,r.jsx)(t.td,{children:"address"}),(0,r.jsx)(t.td,{children:"relayer address"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_ethBridge"}),(0,r.jsx)(t.td,{children:"address"}),(0,r.jsx)(t.td,{})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"_ethWrapped"}),(0,r.jsx)(t.td,{children:"address"}),(0,r.jsx)(t.td,{})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"hashfromreportl2",children:"hashFromReportL2"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function hashFromReportL2(uint256 epoch, struct BridgeInteractionInfo[] bridgeWithdrawInfo, struct StrategyReportL2[] strategyReportL2, struct BridgeInteractionInfo[] bridgeDepositInfo) public pure returns (uint256)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"hashfromreportl1",children:"hashFromReportL1"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function hashFromReportL1(uint256 strategyReportL1Length, struct StrategyReportL1[] strategyReportL1) public pure returns (uint256)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"bridgeethfeesmultiplicator",children:"bridgeEthFeesMultiplicator"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function bridgeEthFeesMultiplicator(struct BridgeInteractionInfo[] bridgeDepositInfo) public view returns (uint256)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"registerstrategy",children:"registerStrategy"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function registerStrategy(address _strategy, address _underlying, address _bridge) public payable\n"})}),"\n",(0,r.jsx)(t.h3,{id:"setpoolingmanager",children:"setPoolingManager"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function setPoolingManager(uint256 _l2PoolingManager) public payable\n"})}),"\n",(0,r.jsx)(t.h3,{id:"canceldepositrequestbridge",children:"cancelDepositRequestBridge"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function cancelDepositRequestBridge(address l1BridgeAddress, uint256 amount, uint256 nonce) public\n"})}),"\n",(0,r.jsx)(t.h3,{id:"claimbridgecanceldepositrequestanddeposit",children:"claimBridgeCancelDepositRequestAndDeposit"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function claimBridgeCancelDepositRequestAndDeposit(address l1BridgeAddress, uint256 amount, uint256 nonce, uint256 l2BridgeEthFee) public payable\n"})}),"\n",(0,r.jsx)(t.h3,{id:"pause",children:"pause"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function pause() external\n"})}),"\n",(0,r.jsx)(t.h3,{id:"unpause",children:"unpause"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function unpause() external\n"})}),"\n",(0,r.jsx)(t.h3,{id:"executependingrequests",children:"executePendingRequests"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function executePendingRequests() public\n"})}),"\n",(0,r.jsx)(t.h3,{id:"handlereport",children:"handleReport"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function handleReport(uint256 epoch, struct BridgeInteractionInfo[] bridgeWithdrawInfo, struct StrategyReportL2[] strategyReportL2, struct BridgeInteractionInfo[] bridgeDepositInfo, uint256 l2BridgeEthFee, uint256 l2MessagingEthFee, uint256 minSuccessCall) public payable\n"})}),"\n",(0,r.jsx)(t.h3,{id:"getmessagepayloaddata",children:"getMessagePayloadData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function getMessagePayloadData(uint256 epoch, uint256 strategyReportL1Hash) internal pure returns (uint256[])\n"})}),"\n",(0,r.jsx)(t.h3,{id:"deleteelement",children:"deleteElement"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function deleteElement(struct StrategyReportL2[] array, uint256 index) internal\n"})}),"\n",(0,r.jsx)(t.h3,{id:"verifycalldata",children:"verifyCallData"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function verifyCallData(uint256 epoch, struct BridgeInteractionInfo[] bridgeWithdrawInfo, struct StrategyReportL2[] strategyReportL2, struct BridgeInteractionInfo[] bridgeDepositInfo) internal\n"})}),"\n",(0,r.jsx)(t.h3,{id:"withdrawfrombridges",children:"withdrawFromBridges"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function withdrawFromBridges(struct BridgeInteractionInfo[] bridgeWithdrawalInfo) internal\n"})}),"\n",(0,r.jsx)(t.h3,{id:"deposittobridges",children:"depositToBridges"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function depositToBridges(struct BridgeInteractionInfo[] bridgeDepositInfo, uint256 l2BridgeEthFee, bool withdrawEth) internal\n"})}),"\n",(0,r.jsx)(t.h3,{id:"handlemassreport",children:"handleMassReport"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function handleMassReport(struct StrategyReportL2[] strategyReportL2, struct BridgeInteractionInfo[] bridgeDepositInfo) internal returns (uint256, struct StrategyReportL1[], struct BridgeInteractionInfo[])\n"})}),"\n",(0,r.jsx)(t.h3,{id:"processstrategyreports",children:"processStrategyReports"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function processStrategyReports(struct StrategyReportL2[] strategyReportL2) internal returns (uint256 strategyReportL1Length, struct StrategyReportL1[] strategyReportL1, uint256 tempBridgeLossLength, struct BridgeInteractionInfo[] tempBridgeLoss)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"processpendingrequests",children:"processPendingRequests"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function processPendingRequests(uint256 strategyReportL1Length, struct StrategyReportL1[] strategyReportL1, struct BridgeInteractionInfo[] bridgeDepositInfo, uint256 pendingRequestsExecutedLength) internal returns (uint256, struct StrategyReportL1[], struct BridgeInteractionInfo[])\n"})}),"\n",(0,r.jsx)(t.h3,{id:"mergereportsandupdatedeposits",children:"mergeReportsAndUpdateDeposits"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function mergeReportsAndUpdateDeposits(uint256 strategyReportL1Length, struct StrategyReportL1[] strategyReportL1, struct BridgeInteractionInfo[] bridgeDepositInfo, uint256 pendingRequestsExecutedLength) internal view returns (uint256 newStrategyReportL1Length, struct StrategyReportL1[] newStrategyReportL1, uint256 tempBridgeAdditionalDepositLength, struct BridgeInteractionInfo[] tempBridgeAdditionalDeposit)\n"})}),"\n",(0,r.jsx)(t.h3,{id:"processpendingrequest",children:"processPendingRequest"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-solidity",children:"function processPendingRequest(uint256 i, uint256 strategyReportL1Length, struct StrategyReportL1[] newStrategyReportL1, struct BridgeInteractionInfo[] bridgeDepositInfo, struct BridgeInteractionInfo[] tempBridgeAdditionalDeposit, uint256 tempBridgeAdditionalDepositLength) internal view returns (uint256)\n"})})]})}function g(e={}){const{wrapper:t}={...(0,s.M)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},2172:(e,t,n)=>{n.d(t,{I:()=>a,M:()=>d});var r=n(1504);const s={},i=r.createContext(s);function d(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);